{%extends "/home/edgar/Desktop/Proyectos/UMAE_db/inventario/templates/inventario/interfaz/base.html"%}
{%load static%}

{%block alerts%}
<div class="alert alert-warning alert-dismissible" role="alert" id="error-alert"><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="alert"></button><span><strong>Algo salio mal, intentelo de nuevo</strong></span></div>
<div id="agregado-alert" class="alert alert-info alert-dismissible" role="alert"><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="alert"></button>
    {%block anuncioAgregado%}
    <span><strong>Contrato agregado de manera exitosa</strong></span>
    {%endblock%}
</div>
<div class="alert alert-danger alert-dismissible" role="alert" id="del-alert"><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="alert"></button>
  {%block anuncioBorrado%}
  <span><strong>Proveedor eliminado de forma exitosa</strong></span>
  {%endblock%}
</div>
{%endblock%}



{%block scripts%}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
<script defer src="{% static 'assets/js/script.js' %}"></script>
<script src="{% static 'assets/js/theme.js' %}"></script>

{%block alertaagregado%}
<script>
    if (localStorage.getItem('displayAgregado') == 'true')
    {
        $(document).ready(function () {
            $("#agregado-alert").fadeTo(5000, 500).slideUp(500, function(){
            $("#agregado-alert").slideUp(500)})
             
        });
        localStorage.setItem('displayAgregado', 'false')
    }
    
</script>
{%endblock%}
{%block POSTform%}
<script>
    $(document).ready(function() {
      $('#agregarform').submit(function(e) {
        e.preventDefault(); 
       
        const formData = $(this).serialize();
  
        const method = 'POST'; 
        const url = '{{request.build_absolute_uri}}'; 
        $.ajax({
          type: method,
          url: url,
          data: formData,
          success: function(response) {
            location.reload()
            localStorage.setItem('displayAgregado', 'true');
            console.log('POST request succesful');

          },
          error: function(error) {
            
            localStorage.setItem('displayError', 'true');
            console.error('POST request failed');
          }
        });
      });
    });
  </script>
  {%endblock%}
<script>
    $("#agregado-alert").hide();
    $("#error-alert").hide();
    $("#del-alert").hide();
    if (localStorage.getItem('displayError') == 'true'){
        $(document).ready(function () {
            $("#error-alert").fadeTo(5000, 500).slideUp(500, function(){
            $("#error-alert").slideUp(500)})
        });
    }

    if (localStorage.getItem('displayBorrado') == 'true') {
      // Display the Bootstrap alert
      $(document).ready(function () {
          $("#del-alert").fadeTo(5000, 500).slideUp(500, function(){
          $("#del-alert").slideUp(500)})
           
      });
  }
    localStorage.setItem('displayBorrado', 'false');
    localStorage.setItem('displayError','false');
    localStorage.setItem('displayAlert', 'false');
</script>
{%endblock%}

